# publishes a release to nmpjs.com

name: build-and-release.yml
on:
  workflow_dispatch: ~
#    inputs:
#      source:
#        description: 'Source *.tgz (from S3 or releases)'
#        required: true
#      version:
#        description: 'Version'
#        required: false
#        default: ''
env:
  NODEJS_VERSION: 14
  GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

jobs:
  linux:
    runs-on: "ubuntu-latest"
    steps:
      - name: Checkout the source code
        uses: actions/checkout@v2
        with:
          ref: main
      - name: Use node.js ${{ env.NODEJS_VERSION }}
        uses: actions/setup-node@v1
        with:
          node-version: ${{ env.NODEJS_VERSION }}
      - name: Install dependencies
        run: |
          sudo apt-get update
          sudo apt-get install -y libasound2-dev
      - name: Build
        run: |
          npm ci
          ./node_modules/.bin/electron-rebuild

          npm run dist

          ls -la dist/
